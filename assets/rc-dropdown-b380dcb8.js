import{b as G,c as J,a as R,d as Q}from"./@babel-9169ff57.js";import{r as o}from"./react-5cc2acaa.js";import{T as U}from"./rc-trigger-278d3dce.js";import{c as x}from"./classnames-5c20d0be.js";import{o as Z,C as $,K as F}from"./rc-util-1f458f21.js";var d={adjustX:1,adjustY:1},g=[0,0],ee={topLeft:{points:["bl","tl"],overflow:d,offset:[0,-4],targetOffset:g},topCenter:{points:["bc","tc"],overflow:d,offset:[0,-4],targetOffset:g},topRight:{points:["br","tr"],overflow:d,offset:[0,-4],targetOffset:g},bottomLeft:{points:["tl","bl"],overflow:d,offset:[0,4],targetOffset:g},bottomCenter:{points:["tc","bc"],overflow:d,offset:[0,4],targetOffset:g},bottomRight:{points:["tr","br"],overflow:d,offset:[0,4],targetOffset:g}},te=F.ESC,ne=F.TAB;function ie(e){var m=e.visible,C=e.setTriggerVisible,u=e.triggerRef,p=e.onVisibleChange,c=e.autoFocus,f=o.useRef(!1),b=function(){if(m&&u.current){var n,r,a,l;(n=u.current)===null||n===void 0||(r=n.triggerRef)===null||r===void 0||(a=r.current)===null||a===void 0||(l=a.focus)===null||l===void 0||l.call(a),C(!1),typeof p=="function"&&p(!1)}},y=function(){var n,r,a,l,O=$((n=u.current)===null||n===void 0||(r=n.popupRef)===null||r===void 0||(a=r.current)===null||a===void 0||(l=a.getElement)===null||l===void 0?void 0:l.call(a)),v=O[0];return v!=null&&v.focus?(v.focus(),f.current=!0,!0):!1},h=function(n){switch(n.keyCode){case te:b();break;case ne:{var r=!1;f.current||(r=y()),r?n.preventDefault():b();break}}};o.useEffect(function(){return m?(window.addEventListener("keydown",h),c&&Z(y,3),function(){window.removeEventListener("keydown",h),f.current=!1}):function(){f.current=!1}},[m])}var re=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus"];function ae(e,m){var C=e.arrow,u=C===void 0?!1:C,p=e.prefixCls,c=p===void 0?"rc-dropdown":p,f=e.transitionName,b=e.animation,y=e.align,h=e.placement,w=h===void 0?"bottomLeft":h,n=e.placements,r=n===void 0?ee:n,a=e.getPopupContainer,l=e.showAction,O=e.hideAction,v=e.overlayClassName,S=e.overlayStyle,L=e.visible,P=e.trigger,T=P===void 0?["hover"]:P,W=e.autoFocus,D=G(e,re),j=o.useState(),V=J(j,2),K=V[0],E=V[1],A="visible"in e?L:K,N=o.useRef(null);o.useImperativeHandle(m,function(){return N.current}),ie({visible:A,setTriggerVisible:E,triggerRef:N,onVisibleChange:e.onVisibleChange,autoFocus:W});var _=function(){var t=e.overlay,i;return typeof t=="function"?i=t():i=t,i},B=function(t){var i=e.onOverlayClick;E(!1),i&&i(t)},H=function(t){var i=e.onVisibleChange;E(t),typeof i=="function"&&i(t)},k=function(){var t=_();return o.createElement(o.Fragment,null,u&&o.createElement("div",{className:"".concat(c,"-arrow")}),t)},I=function(){var t=e.overlay;return typeof t=="function"?k:k()},X=function(){var t=e.minOverlayWidthMatchTrigger,i=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?t:!i},Y=function(){var t=e.openClassName;return t!==void 0?t:"".concat(c,"-open")},q=function(){var t=e.children,i=t.props?t.props:{},z=x(i.className,Y());return A&&t?o.cloneElement(t,{className:z}):t},M=O;return!M&&T.indexOf("contextMenu")!==-1&&(M=["click"]),o.createElement(U,R(R({builtinPlacements:r},D),{},{prefixCls:c,ref:N,popupClassName:x(v,Q({},"".concat(c,"-show-arrow"),u)),popupStyle:S,action:T,showAction:l,hideAction:M||[],popupPlacement:w,popupAlign:y,popupTransitionName:f,popupAnimation:b,popupVisible:A,stretch:X()?"minWidth":"",popup:I(),onPopupVisibleChange:H,onPopupClick:B,getPopupContainer:a}),q())}const fe=o.forwardRef(ae);export{fe as D};
